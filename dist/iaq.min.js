(()=>{"use strict";var e,t=new Uint8Array(16);function a(){if(!e&&!(e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return e(t)}const n=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,r=function(e){return"string"==typeof e&&n.test(e)};for(var i=[],s=0;s<256;++s)i.push((s+256).toString(16).substr(1));const o=function(e,t,n){var s=(e=e||{}).random||(e.rng||a)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=s[o];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=(i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]).toLowerCase();if(!r(a))throw TypeError("Stringified UUID is invalid");return a}(s)};window.IAQ=class{constructor(e,t){this.clientId=e,this.lastUpdated=null,this.host=t||"https://app.hawkenaq.com/api/client",this.interval=null,this.sessionId=o(),this.logged=!1,this.clickUrl="https://a.iaq.ai"}generate(e,t){this.getData(t,!0,e),null==this.interval&&(this.interval=setInterval(this.getData,3e5,t,!0,e))}async reportInit(){try{let e=new URL(this.host+"/event");e.searchParams.append("clientKey",this.clientId),e.searchParams.append("sessionId",this.sessionId),e.searchParams.append("requestUrl",window.location.href),e.searchParams.append("type","init"),(await fetch(e.toString())).json().then((e=>{console.log(e),this.logged=!0}))}catch(e){console.error(e)}}async getData(e,t=!1,a){try{let n=new URL(this.host);n.searchParams.append("clientKey",this.clientId),n.searchParams.append("sessionId",this.sessionId),n.searchParams.append("requestUrl",window.location.href),a?n.searchParams.append("type","generate"):n.searchParams.append("type","data"),e.widgetId&&n.searchParams.append("widgetId",e.widgetId),0==this.logged&&this.reportInit(),Array.isArray(e.measurementIds)&&n.searchParams.append("measurementIds",JSON.stringify(e.measurementIds));let r=await fetch(n.toString()),i=await r.json();return t&&(null!=a?this.updateElement(i,a,e.widgetId):console.warn("Dom not initialize")),console.log(i),i}catch(e){console.error(e)}}getDefaultStyle(e,t){if("data-measurement"==e)return"display: flex;height: 226px;width: 315px;padding-left: 32px;padding-right: 24px;padding-top: 16px;padding-bottom: 0px;color:white;background-color: rgb(37, 41, 74);border-radius: 20px;font-family:Roboto,sans-serif;font-weight:300;text-decoration:none";if("data-measurement-values"==e)return"display:flex;align-items:baseline";if("data-measurement-score"==e)return"font-size:3.2rem";if("data-measurement-unit"==e)return null==t?"display:none":"font-size:1.2rem;margin-left:5px";if("data-name"==e)return"font-size:1.65rem;line-height:2rem;margin-top:1rem";if("data-indicator"==e){if(t){return Number(t)>=75?"display:flex;width:100%;height:30px;justify-content:flex-end;font-size:1.2rem;color:#02c39a":"display:flex;width:100%;height:30px;justify-content:flex-end;font-size:1.2rem;color:#e8912b"}return"display:flex;width:100%;height:30px;justify-content:flex-end;font-size:1.2rem"}return"data-icon"==e?"height:40px;width:40px;margin-bottom:18px":void 0}getIndicatorText(e){return e>=75?"Excellent":e>=50&&e<75?"Moderate":"Poor"}scoreToUse(e){let t;return t="curScore"==e.toUse?Math.round(Number(e.curScore)):isNaN(Number(e.curVal))?e.curVal:Math.round(Number(e.curVal)),String(t)}updateElement(e,t,a){let n="",r=new URL(this.clickUrl+`/wc/${a}`);r.searchParams.append("sessionId",this.sessionId),r.searchParams.append("widgetId",a),r.searchParams.append("requestUrl",window.location.href);for(let t in e.measurements){let a=e.measurements[t];n+=`<a data-measurement="${t}" style="${this.getDefaultStyle("data-measurement")}" href="${r.toString()}" target="_blank">\n            <div data-details style="width:100%">\n                <div data-indicator style="${this.getDefaultStyle("data-indicator",a.curScore)}">${this.getIndicatorText(Number(a.curScore))}</div>\n                <div data-icon style="${this.getDefaultStyle("data-icon")}">${a.icon}</div>\n                <div data-measurement-values style="${this.getDefaultStyle("data-measurement-values")}">\n                    <span data-measurement-score style="${this.getDefaultStyle("data-measurement-score")}">${this.scoreToUse(a)}</span>\n                    <span data-measurement-unit style="${this.getDefaultStyle("data-measurement-unit",a.unit)}">${a.unit}</span>\n                </div>\n                <div data-name style="${this.getDefaultStyle("data-name")}">${a.name}</div>\n            </div>\n        </a>`}t.innerHTML=`<div style="overflow:hidden;width:100%;height:100%;display:flex;align-items:flex-start;justify-content:center;text-decoration:none">${n}</div>`}}})();